#downloading fungi data pathway

#finding pathway of where to store data
(base) Annes-MacBook-Air-3:TeamCoolAnt annekinkopf$ pwd
/Users/annekinkopf/Desktop/TeamCoolAnt
#choosing the raw_data folder to put stuff in
(base) Annes-MacBook-Air-3:TeamCoolAnt annekinkopf$ cd raw_data
(base) Annes-MacBook-Air-3:raw_data annekinkopf$ ls
Fungi
#removing fungi folder and then making a new one for replacing old data
(base) Annes-MacBook-Air-3:raw_data annekinkopf$ rm Fungi
rm: Fungi: is a directory
(base) Annes-MacBook-Air-3:raw_data annekinkopf$ rm dir Fungi
rm: dir: No such file or directory
rm: Fungi: is a directory
(base) Annes-MacBook-Air-3:raw_data annekinkopf$ rmdir Fungi
rmdir: Fungi: Directory not empty
(base) Annes-MacBook-Air-3:raw_data annekinkopf$ rm -r Fungi
(base) Annes-MacBook-Air-3:raw_data annekinkopf$ mkdir Fungi
(base) Annes-MacBook-Air-3:raw_data annekinkopf$ cd Fungi
#to download data into folder path
scp -r akinkopf@staton.newton.utk.edu:/staton/projects/BiGG_CoolAnt/raw_data/Fungi .

#for broken pipes to speed things along and rsync so that it won't double download files
caffeinate rsync -avz akinkopf@staton.newton.utk.edu:/staton/projects/BiGG__CoolAnt/raw_data/Fungi/*gz .

#will allow you to look at stuff you just downloaded
ls -lh




#Importing demultiplexed fastq files for fungi data (making a filter to clean data)

(base) Annes-MacBook-Air-3:Fungi annekinkopf$ mkdir FungiFun
(base) Annes-MacBook-Air-3:Fungi annekinkopf$ cd FungiFun
(base) Annes-MacBook-Air-3:FungiFun annekinkopf$ vi make_manifest.sh
(base) Annes-MacBook-Air-3:FungiFun annekinkopf$ bash make_manifest.sh >> manifest.tsv
(base) Annes-MacBook-Air-3:FungiFun annekinkopf$ ls
make_manifest.sh	manifest.tsv
(base) Annes-MacBook-Air-3:FungiFun annekinkopf$ # load qiime environment
(base) Annes-MacBook-Air-3:FungiFun annekinkopf$ conda activate qiime2-2020.2

#run the import command
(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ qiime tools import \
> --type 'SampleData[PairedEndSequencesWithQuality]' \
> --input-path manifest.tsv \
> --output-path paired-end-demux.qza \
> --input-format PairedEndFastqManifestPhred33V2
Imported manifest.tsv as PairedEndFastqManifestPhred33V2 to paired-end-demux.qza
(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ ls
make_manifest.sh	manifest.tsv		paired-end-demux.qza


#testing out denoising on the fungi
(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ qiime dada2 paired end denoise \
> --i-demultiplexed-seqs paired-end-demux.qza \
> --p-trim-left 20 \
> --p-trunc-len 200 \
> qiime dada2 paired end denoise --i-demultiplexed-seqs paired-end-demux.qza --p-trim-left 20 --p-trunc-len 200 \
> qiime dada2 paired end denoise

(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ ls
make_manifest.sh	manifest.tsv		paired-end-demux.qza

#making a visualization as a qzv file to determine where to cut sequences for the trim and trunc

(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ qiime demux summarize \
> --i-data paired-end-demux.qza \
> --o-visualization paired-end-demux.qzv

(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ qiime demux summarize \
> --i-data paired-end-demux.qza \
> --o-visualization paired-end-demux.qzv
Saved Visualization to: paired-end-demux.qzv

#this "head" command allows to see some things in file (good for making sure you're using the right file)

(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ head manifest.tsv
sample-id	forward-absolute-filepath	reverse-absolute-filepath
1stAMP-NTC_S1_L001	/Users/annekinkopf/Desktop/TeamCoolAnt/raw_data/Fungi/FungiFun/../1stAMP-NTC_S1_L001_R1_001.fastq.gz	/Users/annekinkopf/Desktop/TeamCoolAnt/raw_data/Fungi/FungiFun/../1stAMP-NTC_S1_L001_R2_001.fastq.gz
2ndAMP-NTC_S2_L001	/Users/annekinkopf/Desktop/TeamCoolAnt/raw_data/Fungi/FungiFun/../2ndAMP-NTC_S2_L001_R1_001.fastq.gz	/Users/annekinkopf/Desktop/TeamCoolAnt/raw_data/Fungi/FungiFun/../2ndAMP-NTC_S2_L001_R2_001.fastq.gz
BRA10_S108_L001	/Users/annekinkop........................etc


#tools view allows to see qza file instead of clicking and dragging

(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ qiime tools view paired-end-demux.qzv
Press the 'q' key, Control-C, or Control-D to quit. This view may no longer be accessible or work correctly after quitting.


#denoising final code for fungi file

(qiime2-2020.2) Annes-MacBook-Air-3:FungiFun annekinkopf$ qiime dada2 denoise-paired \
> --i-demultiplexed-seqs paired-end-demux.qza \
> --p-trim-left-f 20 \
> --p-trim-left-r 20 \
> --p-trunc-len-f 200 \
> --p-trunc-len-r 200 \
> --o-representative-sequences rep-seqsF-dada2.qza \
> --o-table tableF-dada2.qza \
> --o-denoising-stats statsF-dada2.qza
